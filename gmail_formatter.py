#!/usr/bin/env python3 

import re


class ComposeEmail:

    def __init__(self, news_art_list = [], xkcd_list = [], cve_list = []) -> None:
        self.news_art_list = news_art_list
        self.xkcd_list = xkcd_list
        self.cve_list = cve_list
        self.tile_1_color = '#9AA5AF'
        self.tile_2_color = '#FFFFFF'
        self.text_1_color = '#000000'
        self.text_2_color = '#000000'

        self.header = '''
            <!DOCTYPE html PUBLIC “-//W3C//DTD XHTML 1.0 Transitional//EN” “https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd”><html lang="en" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:v="urn:schemas-microsoft-com:vml"><head><title>News Email Service</title><meta http–equiv=“Content-Type” content=“text/html; charset=UTF-8” /><meta http–equiv=“X-UA-Compatible” content=“IE=edge” /><meta content="width=device-width, initial-scale=1.0" name="viewport"/><!--[if mso]><xml><o:OfficeDocumentSettings><o:PixelsPerInch>96</o:PixelsPerInch><o:AllowPNG/></o:OfficeDocumentSettings></xml><![endif]--><style>* {box-sizing: border-box;}body {margin: 0;padding: 0;}th.column {padding: 0}a[x-apple-data-detectors] {color: inherit !important;text-decoration: inherit !important;}#MessageViewBody a {color: inherit;text-decoration: none;}p {line-height: inherit}@media (max-width:700px) {.icons-inner {text-align: center;}.icons-inner td {margin: 0 auto;}.row-content {width: 100% !important;}.image_block img.big {width: auto !important;}.stack .column {width: 100%;display: block;}}</style></head><body style="background-color: #141414; margin: 0; padding: 0; -webkit-text-size-adjust: none; text-size-adjust: none;"><table border="0" cellpadding="0" cellspacing="0" class="nl-container" role="presentation" style="mso-table-lspace: 0pt; mso-table-rspace: 0pt; background-color: #141414;" width="100%"><tbody><tr><td><table align="center" border="0" cellpadding="0" cellspacing="0" class="row row-1" role="presentation" style="mso-table-lspace: 0pt; mso-table-rspace: 0pt;" width="100%"><tbody><tr><td><table align="center" border="0" cellpadding="0" cellspacing="0" class="row-content stack" role="presentation" style="mso-table-lspace: 0pt; mso-table-rspace: 0pt; background-color: #000000;" width="680"><tbody><tr><th class="column" style="mso-table-lspace: 0pt; mso-table-rspace: 0pt; font-weight: 400; text-align: left; vertical-align: top; padding-top: 5px; padding-bottom: 5px;" width="100%"><table border="0" cellpadding="0" cellspacing="0" class="image_block" role="presentation" style="mso-table-lspace: 0pt; mso-table-rspace: 0pt;" width="100%"><tr><td style="width:100%;padding-right:0px;padding-left:0px;"><div align="center" style="line-height:10px"><img class="big" src="https://i.imgur.com/wZD2bCB.jpg" style="display: block; height: auto; border: 0; width: 680px; max-width: 100%;" width="680"/></div></td></tr></table></th></tr></tbody></table></td></tr></tbody></table>
            '''
        self.body_title = '''
            <table align="center" border="0" cellpadding="0" cellspacing="0" class="row row-3" role="presentation" style="mso-table-lspace: 0pt; mso-table-rspace: 0pt;" width="100%"><tbody><tr><td><table align="center" border="0" cellpadding="0" cellspacing="0" class="row-content stack" role="presentation" style="mso-table-lspace: 0pt; mso-table-rspace: 0pt; background-color: #d4170b;" width="680"><tbody><tr><th class="column" style="mso-table-lspace: 0pt; mso-table-rspace: 0pt; font-weight: 400; text-align: left; vertical-align: top; padding-top: 5px; padding-bottom: 5px;" width="100%"><table border="0" cellpadding="10" cellspacing="0" class="divider_block" role="presentation" style="mso-table-lspace: 0pt; mso-table-rspace: 0pt;" width="100%"><tr><td><div align="center"><table border="0" cellpadding="0" cellspacing="0" role="presentation" style="mso-table-lspace: 0pt; mso-table-rspace: 0pt;" width="100%"><tr><td class="divider_inner" style="font-size: 1px; line-height: 1px; border-top: 1px solid #000000;"><span></span></td></tr></table></div></td></tr></table></th></tr></tbody></table></td></tr></tbody></table><table align="center" border="0" cellpadding="0" cellspacing="0" class="row row-4" role="presentation" style="mso-table-lspace: 0pt; mso-table-rspace: 0pt;" width="100%"><tbody><tr><td><table align="center" border="0" cellpadding="0" cellspacing="0" class="row-content stack" role="presentation" style="mso-table-lspace: 0pt; mso-table-rspace: 0pt; background-color: #d4170b;" width="680"><tbody><tr><th class="column" style="mso-table-lspace: 0pt; mso-table-rspace: 0pt; font-weight: 400; text-align: left; vertical-align: top; background-color: #d4170c;" width="25%"><table border="0" cellpadding="0" cellspacing="0" class="menu_block" role="presentation" style="mso-table-lspace: 0pt; mso-table-rspace: 0pt;" width="100%"><tr><td style="text-align:left;font-family:inherit;font-size:14px;padding-top:5px;padding-bottom:5px;"><table border="0" cellpadding="0" cellspacing="0" role="presentation" style="mso-table-lspace: 0pt; mso-table-rspace: 0pt;" width="100%"><tr><td style="text-align:left;font-size:0px;"><div class="menu-links"><!--[if mso]><table role="presentation" border="0" cellpadding="0" cellspacing="0" align="center"><tr><td style="padding-top:5px;padding-right:5px;padding-bottom:5px;padding-left:5px"><![endif]--><a href="#News" style="padding-top:5px;padding-bottom:5px;padding-left:5px;padding-right:5px;display:block;color:#FFFFFE;font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;text-decoration:none;letter-spacing:normal;">News</a><!--[if mso]></td></tr><tr><td style="text-align:left;padding-top:5px;padding-right:5px;padding-bottom:5px;padding-left:5px"><![endif]--><a href="#CVEs" style="padding-top:5px;padding-bottom:5px;padding-left:5px;padding-right:5px;display:block;color:#FFFFFE;font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;text-decoration:none;letter-spacing:normal;">CVEs</a><!--[if mso]></td></tr><tr><td style="text-align:left;padding-top:5px;padding-right:5px;padding-bottom:5px;padding-left:5px"><![endif]--><!--[if mso]></td></tr></table><![endif]--></div></td></tr></table></td></tr></table></th><th class="column" style="mso-table-lspace: 0pt; mso-table-rspace: 0pt; font-weight: 400; text-align: left; vertical-align: top; background-color: #d4170c;" width="75%"><table border="0" cellpadding="0" cellspacing="0" class="heading_block" role="presentation" style="mso-table-lspace: 0pt; mso-table-rspace: 0pt;" width="100%"><tr><td style="width:100%;text-align:center;padding-top:5px;padding-bottom:5px;"><h1 style="margin: 0; color: #000002; font-size: 26px; font-family: 'Montserrat', 'Trebuchet MS', 'Lucida Grande', 'Lucida Sans Unicode', 'Lucida Sans', Tahoma, sans-serif; line-height: 120%; text-align: center; direction: ltr; font-weight: normal; letter-spacing: normal; margin-top: 0; margin-bottom: 0;"><strong>News sources pulled every morning and summarized by smmry</strong></h1></td></tr></table></th></tr></tbody></table></td></tr></tbody></table><table align="center" border="0" cellpadding="0" cellspacing="0" class="row row-5" role="presentation" style="mso-table-lspace: 0pt; mso-table-rspace: 0pt;" width="100%"><tbody><tr><td><table align="center" border="0" cellpadding="0" cellspacing="0" class="row-content stack" role="presentation" style="mso-table-lspace: 0pt; mso-table-rspace: 0pt; background-color: #d4170b;" width="680"><tbody><tr><th class="column" style="mso-table-lspace: 0pt; mso-table-rspace: 0pt; font-weight: 400; text-align: left; vertical-align: top; padding-top: 5px; padding-bottom: 5px;" width="100%"><table border="0" cellpadding="10" cellspacing="0" class="divider_block" role="presentation" style="mso-table-lspace: 0pt; mso-table-rspace: 0pt;" width="100%"><tr><td><div align="center"><table border="0" cellpadding="0" cellspacing="0" role="presentation" style="mso-table-lspace: 0pt; mso-table-rspace: 0pt;" width="100%"><tr><td class="divider_inner" style="font-size: 1px; line-height: 1px; border-top: 1px solid #000000;"><span></span></td></tr></table></div></td></tr></table></th></tr></tbody></table></td></tr></tbody></table><table align="center" border="0" cellpadding="0" cellspacing="0" class="row row-6" role="presentation" style="mso-table-lspace: 0pt; mso-table-rspace: 0pt;" width="100%"><tbody><tr><td><table align="center" border="0" cellpadding="0" cellspacing="0" class="row-content stack" role="presentation" style="mso-table-lspace: 0pt; mso-table-rspace: 0pt; background-color: #d4170b;" width="680"><tbody><tr><th class="column" style="mso-table-lspace: 0pt; mso-table-rspace: 0pt; font-weight: 400; text-align: left; vertical-align: top; padding-top: 5px; padding-bottom: 5px;" width="100%"><table border="0" cellpadding="0" cellspacing="0" class="image_block" role="presentation" style="mso-table-lspace: 0pt; mso-table-rspace: 0pt;" width="100%"><tr><td style="width:100%;padding-right:0px;padding-left:0px;"><div align="center" style="line-height:10px"><img alt="alt text" class="big" src="https://i.imgur.com/fBFILH3.jpg" style="display: block; height: auto; border: 0; width: auto; max-width: 100%;" title="alt text" width="680"/></div></td></tr></table></th></tr></tbody></table></td></tr></tbody></table><table align="center" border="0" cellpadding="0" cellspacing="0" class="row row-7" role="presentation" style="mso-table-lspace: 0pt; mso-table-rspace: 0pt;" width="100%"><tbody><tr><td><table align="center" border="0" cellpadding="0" cellspacing="0" class="row-content stack" role="presentation" style="mso-table-lspace: 0pt; mso-table-rspace: 0pt; background-color: #d4170b;" width="680"><tbody><tr><th class="column" style="mso-table-lspace: 0pt; mso-table-rspace: 0pt; font-weight: 400; text-align: left; vertical-align: top; padding-top: 5px; padding-bottom: 5px;" width="100%"><table border="0" cellpadding="10" cellspacing="0" class="divider_block" role="presentation" style="mso-table-lspace: 0pt; mso-table-rspace: 0pt;" width="100%"><tr><td><div align="center"><table border="0" cellpadding="0" cellspacing="0" role="presentation" style="mso-table-lspace: 0pt; mso-table-rspace: 0pt;" width="100%"><tr><td class="divider_inner" style="font-size: 1px; line-height: 1px; border-top: 1px solid #000000;"><span></span></td></tr></table></div></td></tr></table></th></tr></tbody></table></td></tr></tbody></table><table align="center" border="0" cellpadding="0" cellspacing="0" class="row row-8" role="presentation" style="mso-table-lspace: 0pt; mso-table-rspace: 0pt;" width="100%"><tbody><tr><td><table align="center" border="0" cellpadding="0" cellspacing="0" class="row-content stack" role="presentation" style="mso-table-lspace: 0pt; mso-table-rspace: 0pt; background-color: #d4170b;" width="680"><tbody><tr><th class="column" style="mso-table-lspace: 0pt; mso-table-rspace: 0pt; font-weight: 400; text-align: left; vertical-align: top; padding-top: 5px; padding-bottom: 5px;" width="100%"><table border="0" cellpadding="0" cellspacing="0" class="heading_block" role="presentation" style="mso-table-lspace: 0pt; mso-table-rspace: 0pt;" width="100%"><tr><td style="width:100%;text-align:center;"><h2 style="margin: 0; color: #000000; font-size: 20px; font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 120%; text-align: center; direction: ltr; font-weight: normal; letter-spacing: normal; margin-top: 0; margin-bottom: 0;"><a name="News"></a><strong>News of the </strong><strong>Outside</strong></h2></td></tr></table></th></tr></tbody></table></td></tr></tbody></table><table align="center" border="0" cellpadding="0" cellspacing="0" class="row row-9" role="presentation" style="mso-table-lspace: 0pt; mso-table-rspace: 0pt;" width="100%"><tbody><tr><td><table align="center" border="0" cellpadding="0" cellspacing="0" class="row-content stack" role="presentation" style="mso-table-lspace: 0pt; mso-table-rspace: 0pt; background-color: #d4170b;" width="680"><tbody><tr><th class="column" style="mso-table-lspace: 0pt; mso-table-rspace: 0pt; font-weight: 400; text-align: left; vertical-align: top; padding-top: 5px; padding-bottom: 5px;" width="100%"><table border="0" cellpadding="10" cellspacing="0" class="divider_block" role="presentation" style="mso-table-lspace: 0pt; mso-table-rspace: 0pt;" width="100%"><tr><td><div align="center"><table border="0" cellpadding="0" cellspacing="0" role="presentation" style="mso-table-lspace: 0pt; mso-table-rspace: 0pt;" width="100%"><tr><td class="divider_inner" style="font-size: 1px; line-height: 1px; border-top: 1px solid #000000;"><span></span></td></tr></table></div></td></tr></table></th></tr></tbody></table></td></tr></tbody></table>
            '''
        self.body_2_table_header = '''
            <table align="center" border="0" cellpadding="0" cellspacing="0" class="row row-10" role="presentation" style="mso-table-lspace: 0pt; mso-table-rspace: 0pt;" width="100%"><tbody><tr><td><table align="center" border="0" cellpadding="0" cellspacing="0" class="row-content stack" role="presentation" style="mso-table-lspace: 0pt; mso-table-rspace: 0pt; background-color: #d4170b;" width="680"><tbody><tr>
            '''
        self.body_2_table_footer = '''
            </tr></tbody></table></td></tr></tbody></table>
            '''
        self.body_cve_header = '''
            <table align="center" border="0" cellpadding="0" cellspacing="0" class="row row-5" role="presentation" style="mso-table-lspace: 0pt; mso-table-rspace: 0pt;" width="100%"><tbody><tr><td><table align="center" border="0" cellpadding="0" cellspacing="0" class="row-content stack" role="presentation" style="mso-table-lspace: 0pt; mso-table-rspace: 0pt; background-color: #d4170b;" width="680"><tbody><tr><th class="column" style="mso-table-lspace: 0pt; mso-table-rspace: 0pt; font-weight: 400; text-align: left; vertical-align: top; padding-top: 5px; padding-bottom: 5px;" width="100%"><table border="0" cellpadding="10" cellspacing="0" class="divider_block" role="presentation" style="mso-table-lspace: 0pt; mso-table-rspace: 0pt;" width="100%"><tr><td><div align="center"><table border="0" cellpadding="0" cellspacing="0" role="presentation" style="mso-table-lspace: 0pt; mso-table-rspace: 0pt;" width="100%"><tr><td class="divider_inner" style="font-size: 1px; line-height: 1px; border-top: 1px solid #000000;"><span></span></td></tr></table></div></td></tr></table></th></tr></tbody></table></td></tr></tbody></table><table align="center" border="0" cellpadding="0" cellspacing="0" class="row row-15" role="presentation" style="mso-table-lspace: 0pt; mso-table-rspace: 0pt;" width="100%"><tbody><tr><td><table align="center" border="0" cellpadding="0" cellspacing="0" class="row-content stack" role="presentation" style="mso-table-lspace: 0pt; mso-table-rspace: 0pt; background-color: #d4170b;" width="680"><tbody><tr><th class="column" style="mso-table-lspace: 0pt; mso-table-rspace: 0pt; font-weight: 400; text-align: left; vertical-align: top; padding-top: 5px; padding-bottom: 5px;" width="100%"><table border="0" cellpadding="0" cellspacing="0" class="heading_block" role="presentation" style="mso-table-lspace: 0pt; mso-table-rspace: 0pt;" width="100%"><tr><td style="width:100%;text-align:center;"><h2 style="margin: 0; color: #000000; font-size: 18px; font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 120%; text-align: center; direction: ltr; font-weight: normal; letter-spacing: normal; margin-top: 0; margin-bottom: 0;"><a name="CVEs"></a><strong>20 of the latest CVEs from the NVD</strong></h2></td></tr></table></th></tr></tbody></table></td></tr></tbody></table><table align="center" border="0" cellpadding="0" cellspacing="0" class="row row-16" role="presentation" style="mso-table-lspace: 0pt; mso-table-rspace: 0pt;" width="100%"><tbody><tr><td><table align="center" border="0" cellpadding="0" cellspacing="0" class="row-content stack" role="presentation" style="mso-table-lspace: 0pt; mso-table-rspace: 0pt; background-color: #d4170b;" width="680"><tbody><tr><th class="column" style="mso-table-lspace: 0pt; mso-table-rspace: 0pt; font-weight: 400; text-align: left; vertical-align: top; padding-top: 5px; padding-bottom: 5px;" width="100%"><table border="0" cellpadding="10" cellspacing="0" class="divider_block" role="presentation" style="mso-table-lspace: 0pt; mso-table-rspace: 0pt;" width="100%"><tr><td><div align="center"><table border="0" cellpadding="0" cellspacing="0" role="presentation" style="mso-table-lspace: 0pt; mso-table-rspace: 0pt;" width="100%"><tr><td class="divider_inner" style="font-size: 1px; line-height: 1px; border-top: 1px solid #000000;"><span></span></td></tr></table></div></td></tr></table></th></tr></tbody></table></td></tr></tbody></table>
            '''
        self.footer = '''
            <table align="center" border="0" cellpadding="0" cellspacing="0" class="row row-30" role="presentation" style="mso-table-lspace: 0pt; mso-table-rspace: 0pt;" width="100%"><tbody><tr><td><table align="center" border="0" cellpadding="0" cellspacing="0" class="row-content stack" role="presentation" style="mso-table-lspace: 0pt; mso-table-rspace: 0pt; background-color: #000000;" width="680"><tbody><tr><th class="column" style="mso-table-lspace: 0pt; mso-table-rspace: 0pt; font-weight: 400; text-align: left; vertical-align: top; padding-top: 5px; padding-bottom: 5px;" width="100%"><table border="0" cellpadding="0" cellspacing="0" class="icons_block" role="presentation" style="mso-table-lspace: 0pt; mso-table-rspace: 0pt;" width="100%"><tr><td style="color:#9d9d9d;font-family:inherit;font-size:15px;padding-bottom:5px;padding-top:5px;text-align:center;"><table cellpadding="0" cellspacing="0" role="presentation" style="mso-table-lspace: 0pt; mso-table-rspace: 0pt;" width="100%"><tr><td style="text-align:center;"><!--[if vml]><table align="left" cellpadding="0" cellspacing="0" role="presentation" style="display:inline-block;padding-left:0px;padding-right:0px;mso-table-lspace: 0pt;mso-table-rspace: 0pt;"><![endif]--><!--[if !vml]><!--><table cellpadding="0" cellspacing="0" class="icons-inner" role="presentation" style="mso-table-lspace: 0pt; mso-table-rspace: 0pt; display: inline-block; margin-right: -4px; padding-left: 0px; padding-right: 0px;"><!--<![endif]--></table></td></tr></table></td></tr></table></th></tr></tbody></table></td></tr></tbody></table></td></tr></tbody></table><!-- End --></body></html>
            '''
    
    def article(self,art_type_list:list[list[str]])->str:
        output = []
        
        for i, art in enumerate(art_type_list, start=1):
          color_tx, color_bg = self.color_4_tile(i)
          source = re.compile(r'^(?:https?:\/\/)(?:[^@\/\n]+@)?(?:www\.)?([^:\/?\n]+)').search(art[1]).group(1)
          content = f'''
            <th class="column" style="mso-table-lspace: 0pt; mso-table-rspace: 0pt; font-weight: 400; text-align: left; vertical-align: top; background-color: {color_bg};" width="50%"><table border="0" cellpadding="0" cellspacing="0" class="text_block" role="presentation" style="mso-table-lspace: 0pt; mso-table-rspace: 0pt; word-break: break-word;" width="100%"><tr><td style="padding-top:15px;padding-right:10px;padding-bottom:15px;padding-left:10px;"><div style="font-family: sans-serif"><div style="font-size: 14px; color: {color_tx}; line-height: 1.2; font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;"><p style="margin: 0; font-size: 14px; text-align: center;"><span style="font-size:20px;">{art[0]}</span></p><p style="margin: 0; font-size: 14px; text-align: right;"><span style="font-size:12px;"><a href="{art[1]}" target="_blank">{source}</a></span></p><p style="margin: 0; font-size: 14px; text-align: left;"><span style="font-size:14px;">{art[2]} </span></p></div></div></td></tr></table></th>
            '''  
      
          content = self.tabler_2_wide(i, content, len(art_type_list))
          output.append(content)
        return ' '.join(output)

    def tabler_2_wide(self, i, content, length):
        if length%2 != 0 and length == i:
          content = self.body_2_table_header + content + self.body_2_table_footer
        elif i%2 != 0:
          content = self.body_2_table_header + content
        else:
          content = content + self.body_2_table_footer
        return content

    def color_4_tile(self, i):
        if i%4 == 1:
          color_bg = self.tile_1_color
          color_tx = self.text_1_color
        elif i%4 == 2:
          color_bg = self.tile_2_color
          color_tx = self.text_2_color
        elif i%4 == 3:
          color_bg = self.tile_2_color
          color_tx = self.text_2_color
        elif i%4 == 0:
          color_bg = self.tile_1_color
          color_tx = self.text_1_color
        return [color_tx, color_bg]
    
    def xkcd_comic(self)->str:
        comic = self.xkcd_list 
        output = f'''
          <table align="center" border="0" cellpadding="0" cellspacing="0" class="row row-2" role="presentation" style="mso-table-lspace: 0pt; mso-table-rspace: 0pt;" width="100%"><tbody><tr><td><table align="center" border="0" cellpadding="0" cellspacing="0" class="row-content stack" role="presentation" style="mso-table-lspace: 0pt; mso-table-rspace: 0pt; background-color: #141414;" width="680"><tbody><tr><th class="column" style="mso-table-lspace: 0pt; mso-table-rspace: 0pt; font-weight: 400; text-align: left; vertical-align: top; padding-top: 5px; padding-bottom: 5px;" width="100%"><table border="0" cellpadding="0" cellspacing="0" class="image_block" role="presentation" style="mso-table-lspace: 0pt; mso-table-rspace: 0pt;" width="100%"><tr><td style="width:100%;padding-right:0px;padding-left:0px;"><div align="center" style="line-height:10px"><img alt="{comic[0]}" src="{comic[1]}" style="display: block; height: auto; border: 0; width: auto; max-width: 100%;" title="{comic[2]}" width="640"/></div></td></tr></table></th></tr></tbody></table></td></tr></tbody></table>
          '''
        return output

    def final_draft(self)->str:
        comic = self.xkcd_comic()
        art_block = self.article(self.news_art_list)
        cve_block = self.article(self.cve_list)
        
        
        email = self.header + comic + self.body_title + art_block + self.body_cve_header + cve_block + self.footer 
        
        return email

def main():
    
    # # art_dump = [['Couple Arrested Over Sale of Nuclear Secrets', 'https://www.infosecurity-magazine.com/news/couple-arrested-over-sale-of/', 'Jonathan and Diana Toebbe, both of Annapolis, were arrested in Jefferson County, West Virginia, by the FBI and the Naval Criminal Investigative Service on Saturday, October 9. It is alleged that 42-year-old Naval nuclear engineer Jonathan Toebbe, with the help of his 45-year-old wife, sold information classified as Restricted Data to an undercover FBI agent who they believed was a representative of a foreign power. After receiving a $10,000 advance payment, Toebbe and his wife allegedly arranged to leave an SD card containing the data at a pre-arranged location in West Virginia on June 26. The agent retrieved the card and paid Jonathan Toebbe $20,000 for the encryption key. The FBI arrested Jonathan and Diana Toebbe on October 9, after he placed a third SD card at a pre-arranged location in West Virginia.'], ['US Imprisons Man Who Exploited Children Via Social Media', 'https://www.infosecurity-magazine.com/news/imprisons-man-exploited-children/', 'A sexual predator who used social media apps to victimize minors has been sent to prison in the United States. Jacob Blanco, of Fresno, California, used several ruses to manipulate children as young as six years old into producing sexually explicit material and then sharing it with him. In May 2020, Blanco pleaded guilty to five counts of sexual exploitation of a minor and receipt and distribution of material involving sexual exploitation of minors. Acting US Attorney Phillip Talbert for the Eastern District of California said: "The fact that the defendant used social media to sexually exploit the victims serves as a reminder that the internet can be a dangerous place especially for children." Blanco\'s sentencing comes a month after the National Center on Sexual Exploitation urged TikTok to do more to protect minors using its platform.'], ['Hospital Hacker Steals Patients’ Data', 'https://www.infosecurity-magazine.com/news/hospital-hacker-steals-patients/', 'Data belonging to patients of a hospital in New Mexico has been deleted by an unknown cyber-attacker. The hospital said: "Upon learning of the issue, SJRMC immediately took steps to secure the network and mitigate against any additional harm. After an extensive forensic investigation, we determined that as part of this incident, an unauthorized individual removed information from our network September 7-8, 2020.". The hospital discovered on July 13, 2021, that those files had contained "The personal and protected health information of certain patients." The hospital said on October 7 that it is notifying the patients whose data was affected by the incident. "Nevertheless, in addition to providing this website notice, SJRMC is sending notification to all affected patients for whom we have enough information to determine a physical address. We have also set up a dedicated call center," said the hospital.'], ['Android Phones Sharing Significant User Data Without Opt-Outs', 'https://www.infosecurity-magazine.com/news/android-user-data-opt-outs/', 'Roid mobile phones are undertaking significant data sharing without offering opt-outs for users, according to a new report by researchers at Trinity College Dublin and the University of Edinburgh. For the study, the team analyzed six variants of the Android OS to determine the amount of data they are sending to developers and third parties with pre-installed system apps, such as Google, Microsoft, LinkedIn and Facebook. The researchers noted that third-party system apps from companies such as Google, Microsoft, LinkedIn and Facebook are pre-installed on most handsets analyzed and silently collected data without opt-out. "Prof Doug Leith, chair of computer systems at the School of Computer Science and Statistics, Trinity College Dublin, commented:"I think we have completely missed the massive and ongoing data collection by our phones, for which there is no opt out. "The business impact is the financial cost associated with legal fees and potential privacy regulatory fines as a result of not adhering to GDPR compliance requirements. There are also financial implications with employee compensation if found that the privacy of their data was not adhered to both from a business collection purpose and/or if adequate protection controls were not in place leading to the result of their data being breached."'], ['Most Insurers Mandate MFA, But Premiums Are Still Soaring ', 'https://www.infosecurity-magazine.com/news/most-insurers-mandate-mfa-premiums/', 'US cyber-insurers are increasing premiums and lowering coverage limits despite mandating stricter security controls as a pre-requisite for coverage, according to a new report. The US Cyber Market Outlook from wholesale insurance broker Risk Placement Services warns that providers have been "Battered" by higher-than-anticipated recent losses and are now generally charging much more for less coverage. Sectors hit hard over the past year, including education, government, healthcare, construction and manufacturing, have seen premiums increase by 300% or more at renewal time. Such controls are becoming increasingly widespread, according to RPS. Multi-factor authentication is now described as a "Must-have" to even qualify for coverage. A Government Accountability Office study from May claimed that take-up of cyber-specific insurance policies had doubled to around half in 2020, but that successful attacks had also led to rising premiums and reduced coverage limits for some.'], ['Banking Insider Accused of Role in $1m BEC Scheme', 'https://www.infosecurity-magazine.com/news/banking-insider-accused-role-bec/', "Three men including one former bank employee have been indicted by a federal grand jury for their alleged role in a business email compromise conspiracy. Onyewuchi Ibeh, 21, of Bowie, Maryland, Jason Joyner, 42, of Washington, DC and Mouaaz Elkhebri, 30, of Alexandria, Virginia, were charged with money laundering and aggravated identity theft, according to a superseding indictment late last week. At least five businesses lost over $1.1m in total over the period, with the co-conspirators laundering the funds through dozens of bank accounts, according to the Department of Justice. Ibeh apparently managed the money laundering process, directing the others to open accounts which he used to wire money around the world. Elkhebri is charged with conspiracy to commit money laundering, money laundering, false entries in a bank's books, and aggravated identity theft - charges which carry a maximum of 52 years."], ['Ransomware Intrusion Group FIN12 Ramps-Up in Europe', 'https://www.infosecurity-magazine.com/news/ransomware-intrusion-group-fin12/', 'A long-running threat group with a track record of rapid ransomware deployment and healthcare sector victims is ramping up its operations in Europe and APAC, Mandiant has warned. In a new report detailing the work of FIN12, the threat intelligence firm claimed that the prolific threat group had focused mainly on North American targets since its activities were first recorded in 2018. The bad news for organizations elsewhere in the world is that FIN12 appears to be changing its geographical focus. The group apparently uses Ryuk ransomware to target organizations with over $300m in revenue, partnering with other actors in the cyber underground for initial access, especially those affiliated with Trickbot and BazarLoader malware. Through these partnerships and by eschewing double extortion tactics, FIN12 has dramatically cut the time it takes to deploy ransomware to victim networks.']]
    # comic_dump = ['Integration by Parts', 'https://imgs.xkcd.com/comics/integration_by_parts.png', "If you can manage to choose u and v such that u = v = x, then the answer is just (1/2)x^2, which is easy to remember. Oh, and add a '+C' or you'll get yelled at."]
    # cve_dump = [['CVE-2021-34788', 'https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-anyconnect-lib-hija-cAFB7x4q', 'A vulnerability in the shared library loading mechanism of Cisco AnyConnect Secure Mobility Client for Linux and Mac OS could allow an authenticated, local attacker to perform a shared library hijacking attack on an affected device if the VPN Posture (HostScan) Module is installed on the AnyConnect client. This vulnerability is due to a race condition in the signature verification process for shared library files that are loaded on an affected device. An attacker could exploit this vulnerability by sending a series of crafted interprocess communication (IPC) messages to the AnyConnect process. A successful exploit could allow the attacker to execute arbitrary code on the affected device with root privileges. To exploit this vulnerability, the attacker must have a valid account on the system.'], ['CVE-2021-34757', 'https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-sb-hardcoded-cred-MJCEXvX', 'Multiple vulnerabilities in Cisco Business 220 Series Smart Switches firmware could allow an attacker with Administrator privileges to access sensitive login credentials or reconfigure the passwords on the user account. For more information about these vulnerabilities, see the Details section of this advisory.'], ['CVE-2021-34772', 'https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-amp-redirect-rQ2Bu7dU', 'A vulnerability in the web-based management interface of Cisco Orbital could allow an unauthenticated, remote attacker to redirect users to a malicious webpage. This vulnerability is due to improper validation of URL paths in the web-based management interface. An attacker could exploit this vulnerability by persuading a user to click a crafted URL. A successful exploit could allow the attacker to redirect a user to a malicious website. This vulnerability, known as an open redirect attack, is used in phishing attacks to persuade users to visit malicious sites.'], ['CVE-2021-23857', 'https://psirt.bosch.com/security-advisories/bosch-sa-741752.html', 'Login with hash: The login routine allows the client to log in to the system not by using the password, but by using the hash of the password. Combined with CVE-2021-23858, this allows an attacker to subsequently login to the system.'], ['CVE-2021-29798', 'https://www.ibm.com/support/pages/node/6495925', 'IBM Sterling B2B Integrator Standard Edition 6.0.0.0 through 6.1.1.0 is vulnerable to SQL injection. A remote attacker could send specially crafted SQL statements, which could allow the attacker to view, add, modify or delete information in the back-end database. IBM X-Force ID: 203734.'], ['CVE-2021-29836', 'https://www.ibm.com/support/pages/node/6495921', 'IBM Sterling B2B Integrator Standard Edition 5.2.0.0. through 6.1.1.0 is vulnerable to cross-site scripting. This vulnerability allows users to embed arbitrary JavaScript code in the Web UI thus altering the intended functionality potentially leading to credentials disclosure within a trusted session. IBM X-Force ID: 204912.'], ['CVE-2021-42369', 'https://github.com/dawid-czarnecki/public-vulnerabilities/tree/master/Imagicle/CVE', 'Imagicle Application Suite (for Cisco UC) before 2021.Summer.2 allows SQL injection. A low-privileged user could inject a SQL statement through the "Export to CSV" feature of the Contact Manager web GUI.'], ['CVE-2021-42224', 'https://www.exploit-db.com/exploits/50391', 'SQL Injection vulnerability exists in IFSC Code Finder Project 1.0 via the searchifsccode POST parameter in /search.php.'], ['CVE-2021-41617', 'https://www.openwall.com/lists/oss-security/2021/09/26/1', 'sshd in OpenSSH 6.2 through 8.x before 8.8, when certain non-default configurations are used, allows privilege escalation because supplemental groups are not initialized as expected. Helper programs for AuthorizedKeysCommand and AuthorizedPrincipalsCommand may run with privileges associated with group memberships of the sshd process, if the configuration specifies running the command as a different user.'], ['CVE-2021-32571', 'https://www.gruppotim.it/it/innovazione/servizi-digitali/cybersecurity/red-team.html', '** UNSUPPORTED WHEN ASSIGNED ** In OSS-RC systems of the release 18B and older during data migration procedures certain files containing usernames and passwords are left in the system undeleted but in folders accessible by top privileged accounts only. NOTE: This vulnerability only affects products that are no longer supported by the maintainer. Ericsson Network Manager is a new generation OSS system which OSS-RC customers shall upgrade to.'], ['CVE-2021-29837', 'https://exchange.xforce.ibmcloud.com/vulnerabilities/204913', 'IBM Sterling B2B Integrator Standard Edition 5.2.0.0 through 6.1.1.0 is vulnerable to cross-site request forgery which could allow an attacker to execute malicious and unauthorized actions transmitted from a user that the website trusts. IBM X-Force ID: 204913.'], ['CVE-2021-34758', 'https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-tpce-rmos-mem-dos-rck56tT', 'A vulnerability in the memory management of Cisco TelePresence Collaboration Endpoint (CE) Software and Cisco RoomOS Software could allow an authenticated, local attacker to corrupt a shared memory segment, resulting in a denial of service (DoS) condition. This vulnerability is due to insufficient access controls to a shared memory resource. An attacker could exploit this vulnerability by corrupting a shared memory segment on an affected device. A successful exploit could allow the attacker to cause the device to reload. The device will recover from the corruption upon reboot.'], ['CVE-2021-29855', 'https://exchange.xforce.ibmcloud.com/vulnerabilities/205684', 'IBM Sterling B2B Integrator Standard Edition 5.2.0.0 through 6.1.1.0 is vulnerable to cross-site scripting. This vulnerability allows users to embed arbitrary JavaScript code in the Web UI thus altering the intended functionality potentially leading to credentials disclosure within a trusted session. IBM X-Force ID: 205684.'], ['CVE-2021-29903', 'https://www.ibm.com/support/pages/node/6495919', 'IBM Sterling B2B Integrator Standard Edition 5.2.6.0 through 6.1.1.0 is vulnerable to SQL injection. A remote attacker could send specially crafted SQL statements, which could allow the attacker to view, add, modify or delete information in the back-end database. IBM X-Force ID: 207506.'], ['CVE-2021-38925', 'https://www.ibm.com/support/pages/node/6495905', 'IBM Sterling B2B Integrator Standard Edition 5.2.0. 0 through 6.1.1.0 uses weaker than expected cryptographic algorithms that could allow an attacker to decrypt highly sensitive information. IBM X-Force ID: 210171.'], ['CVE-2021-25496', 'https://security.samsungmobile.com/serviceWeb.smsb?year=2021&month=10', 'A possible buffer overflow vulnerability in maetd_dec_slice of libSPenBase library of Samsung Notes prior to Samsung Notes version 4.3.02.61 allows arbitrary code execution.'], ['CVE-2021-25497', 'https://security.samsungmobile.com/serviceWeb.smsb?year=2021&month=10', 'A possible buffer overflow vulnerability in maetd_cpy_slice of libSPenBase library of Samsung Notes prior to Samsung Notes version 4.3.02.61 allows arbitrary code execution.'], ['CVE-2021-42341', 'https://github.com/OpenRC/openrc/issues/459', "checkpath in OpenRC before 0.44.7 uses the direct output of strlen() to allocate strings, which does not account for the '\\0' byte at the end of the string. This results in memory corruption. CVE-2021-42341 was introduced in git commit 63db2d99e730547339d1bdd28e8437999c380cae, which was introduced as part of OpenRC 0.44.0 development."], ['CVE-2021-42228', 'https://github.com/kindsoft/kindeditor/issues/337', 'Cross Site Request Forgery (CSRF) vulnerability exists in KindEdirot 4.1.x. First, you upload an html file containing csrf on the website that uses a google editor, (you only need to search in google: inurl:/examples/uploadbutton.html) and then use the authority of this website to trick users into clicking your malicious html link.'], ['CVE-2021-42227', 'https://github.com/kindsoft/kindeditor/issues/336', 'Cross SIte Scripting (XSS) vulnerability exists in KindEditor 4.1.x via a Google search inurl:/examples/uploadbutton.html and then the .html file on the website that uses this editor (the file suffix is allowed).']]
    # # art_dump.sort(key=lambda s: -len(s[2]))
    # cve_dump.sort(key=lambda s: -len(s[2]))
    
    
    
    
    # with open('test.txt','r') as f:
    #   test_art = f.read()
    # test_art = eval(test_art.strip())
    # test_art.sort(key=lambda s: -len(s[2]))
    
    # d_email = ComposeEmail(news_art_list=test_art,xkcd_list=comic_dump,cve_list=cve_dump).final_draft()
    
    # with open('test6.html','w') as f:
    #     f.write(d_email)
    
    # with open('test_cve.txt','r') as f:
    #   test_cve = f.read()
    # test_cve = eval(test_cve.strip())
    # test_cve.sort(key=lambda s: -len(s[2]))
        
    # f_email = ComposeEmail(news_art_list=test_art,xkcd_list=comic_dump,cve_list=test_cve).final_draft()
    # with open('test2.html','w') as f:
    #     f.write(f_email)
    
    pass

if __name__=='__main__':
    main()
